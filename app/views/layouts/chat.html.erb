<!DOCTYPE html>
<html>
  <head>
    <title>Chat Application</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag 'application', media: 'all' %>
    <%= javascript_importmap_tags %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload" %>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <header class="p-3 bg-dark text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="h4 mb-0">ChatGPT Clone</h1>
            <%= form_tag destroy_user_session_path, method: :delete do %>
                <%= submit_tag "Logout", class: "btn btn-outline-light me-3" %>
            <% end %>
            <div class="d-flex align-items-center">
                <button id="theme-toggle" class="btn btn-outline-light">Switch to Dark Mode</button>
            </div>
        </div>
    </header>

    <div class="d-flex" id="wrapper">
      <!-- Sidebar-->
      <div class="border-end bg-white" id="sidebar-wrapper">
        <div class="sidebar-heading border-bottom bg-light">Past Chats</div>
        <div class="mb-3">
            <%= form_tag chats_path, method: :post do %>
                <%= submit_tag "+ New Chat" %>
            <% end %>
        </div>
        <div class="list-group list-group-flush">
            <turbo-frame id="user-chats">
                <ul class="list-unstyled">
                    <%= render partial: "chats/chat", collection: current_user.chats.order(created_at: :desc), as: :chat %>
                </ul>
            </turbo-frame>
        </div>
      </div>
      <!-- Page content wrapper-->
      <div id="page-content-wrapper">
        <!-- Top navigation-->
        <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
          <div class="container-fluid">
            <button class="btn btn-primary" id="sidebarToggle">Toggle Menu</button>
          </div>
        </nav>
        <!-- Page content-->
        <div class="container-fluid">
          <h1 class="mt-4">Chats</h1>
        </div>
      </div>
    </div>
    <!-- Bootstrap core JS -->
    
    <!-- Custom JavaScript -->
  </body>
</html>




<script>
      document.addEventListener('DOMContentLoaded', () => {
        // Theme Toggle
        const body = document.body;
        const button = document.getElementById('theme-toggle');
    
        button.addEventListener('click', () => {
          const currentTheme = body.getAttribute('data-theme') || 'light';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          body.setAttribute('data-theme', newTheme);
          button.textContent = newTheme === 'light' ? 'Switch to Dark Mode' : 'Switch to Light Mode';
        });
    
        // Sidebar Toggle
        const sidebarToggle = document.getElementById('sidebarToggle');
        if (sidebarToggle) {
            sidebarToggle.addEventListener('click', (event) => {
            event.preventDefault();

            // Toggle the class on the body
            document.body.classList.toggle('sb-sidenav-toggled');

            // Store the state in localStorage
            const isToggled = document.body.classList.contains('sb-sidenav-toggled');
            localStorage.setItem('sb|sidebar-toggle', isToggled);
            });
        }

        // Apply the saved state on page load
        const isToggled = localStorage.getItem('sb|sidebar-toggle') === 'true';
        if (isToggled) {
            document.body.classList.add('sb-sidenav-toggled');
        }
        });
</script>