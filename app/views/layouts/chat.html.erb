<!DOCTYPE html>
<html>
  <head>
    <title>Chat Application</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag 'application', media: 'all' %>
    <%= javascript_importmap_tags %>

  </head>
  <body>
    <header class="p-3 bg-dark text-white">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="h4 mb-0">ChatGPT Clone</h1>
        <%= form_tag destroy_user_session_path, method: :delete do %>
          <%= submit_tag "Logout", class: "btn btn-outline-light" %>
        <% end %>
        <button id="theme-toggle">Switch to Dark Mode</button>
      </div>
    </header>

    <div class="d-flex" style="height: calc(100vh - 56px);">
      <!-- Sidebar -->
      <aside class="sidebar text-white p-3">
        <div class="mb-3">
            <%= button_to '+ New Chat', chats_path, method: :post, class: 'btn btn-outline-light w-100' if current_user.present? %>
        </div>
        <% if current_user.present? %>
            <div class="mt-3">
            <h4>Today:</h4>
            <turbo-frame id="user-chats">
                <ul class="list-unstyled">
                    <%= render partial: "chats/chat", collection: current_user.chats.order(created_at: :desc), as: :chat %>
                </ul>
            </turbo-frame>
            </div>
        <% end %>
        </aside>


      <!-- Chat Area -->
      <main class="flex-grow-1 p-3">
        <p> Hello World </p>
      </main>
    </div>
  </body>
</html>





<script>
    // Theme Toggle Script
    const body = document.body;
    const button = document.getElementById('theme-toggle');

    button.addEventListener('click', () => {
        const currentTheme = body.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        body.setAttribute('data-theme', newTheme);
        button.textContent = newTheme === 'light' ? 'Switch to Dark Mode' : 'Switch to Light Mode';
    });
</script>